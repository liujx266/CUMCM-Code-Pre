# 数值积分方法 (Numerical Integration)

## 模型简介

数值积分是计算定积分近似值的数值方法，当被积函数的原函数难以求出或积分区域复杂时，数值积分成为求解积分的重要手段。包含Simpson法、梯形法等经典算法。

## 适用场景

### 数学建模竞赛中的典型应用

1. **面积体积计算** - 不规则图形面积、复杂几何体体积
2. **物理量计算** - 功、功率、质量、重心等积分量
3. **概率统计** - 概率密度函数积分、期望值计算
4. **工程应用** - 信号处理中的能量计算
5. **经济模型** - 总成本、总收益等累积量计算
6. **优化问题** - 目标函数为积分形式的优化
7. **微分方程** - 数值解中涉及的积分计算
8. **数据处理** - 离散数据的数值积分

### 典型问题特征

- 被积函数无法求出解析解
- 积分区域为不规则形状
- 需要高精度的积分计算
- 多重积分问题

## 算法原理

### Simpson 1/3法则

将积分区间等分为偶数个子区间，用抛物线拟合函数：

$$\int_a^b f(x)dx \approx \frac{h}{3}[f(a) + 4\sum_{i=1,3,5...}^{n-1}f(x_i) + 2\sum_{i=2,4,6...}^{n-2}f(x_i) + f(b)]$$

其中 $h = \frac{b-a}{n}$，精度为 $O(h^4)$

### 梯形法

用直线段连接函数值，形成梯形近似：

$$\int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{i=1}^{n-1}f(x_i) + f(b)]$$

精度为 $O(h^2)$，比Simpson法精度低但计算简单

### 二重积分

通过逐次积分计算，先对内层变量积分，再对外层变量积分

## 使用方法

### 1. 一元函数积分

```python
from M_A2_NumericalIntegration import simpson_integration
import numpy as np

# 计算 ∫[0,π] sin(x) dx
result = simpson_integration(np.sin, 0, np.pi, n=1000)
print(f"积分结果: {result:.6f}")  # 理论值: 2.0
```

### 2. 自定义函数积分

```python
# 计算 ∫[0,2] (x³ + 2x) dx
def my_function(x):
    return x**3 + 2*x

result = simpson_integration(my_function, 0, 2, n=500)
```

### 3. 二重积分

```python
from M_A2_NumericalIntegration import double_integration

# 计算 ∫∫[0,1]×[0,1] (x² + y²) dxdy
def func_2d(x, y):
    return x**2 + y**2

result = double_integration(func_2d, (0, 1), (0, 1), nx=100, ny=100)
```

### 4. 复杂区域积分

```python
# 计算在区域 0≤x≤1, x²≤y≤x 上的积分
def upper_bound(x):
    return x

def lower_bound(x):
    return x**2

def integrand(x, y):
    return x + y

result = double_integration(integrand, (0, 1), (lower_bound, upper_bound))
```

## 算法特点

### 优点
1. **通用性强** - 适用于任何连续函数
2. **精度可控** - 通过增加分割数提高精度
3. **实现简单** - 算法逻辑清晰易懂
4. **稳定性好** - 对函数光滑性要求不高

### 缺点
1. **计算量大** - 高精度需要大量函数计算
2. **维数灾难** - 高维积分计算量指数增长
3. **边界敏感** - 函数在边界处的奇异性影响精度

## 注意事项

### 精度控制
1. **分割数选择**: 一般n≥1000，光滑函数可适当减少
2. **方法选择**: Simpson法优于梯形法，但计算量稍大
3. **收敛性检验**: 比较不同n值的结果判断收敛

### 特殊情况
1. **振荡函数**: 需要足够密的网格捕获振荡
2. **奇异点**: 避开积分区间内的奇点
3. **无穷区间**: 通过变量替换转化为有限区间

## 代码文件

- **文件名**: `M_A2_NumericalIntegration.py`
- **主函数**: 
  - `simpson_integration(func, a, b, n)`: Simpson法一元积分
  - `trapezoidal_integration(func, a, b, n)`: 梯形法一元积分
  - `double_integration(func, x_bounds, y_bounds, nx, ny)`: 二重积分
- **示例**: 正弦函数、二次函数、二元函数的积分计算

## 扩展应用

### 高级技巧
1. **自适应积分**: 根据局部误差自动调整步长
2. **Gauss积分**: 更高精度的数值积分方法
3. **Monte Carlo积分**: 适用于高维积分的随机方法
4. **符号积分**: 结合符号计算提高精度

### 实际应用
1. **工程计算**: 结构受力、流体力学中的积分量
2. **物理建模**: 电磁场、量子力学中的积分计算
3. **经济分析**: 效用函数、成本函数的积分
4. **数据分析**: 概率分布函数的数值积分