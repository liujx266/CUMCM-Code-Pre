# 四阶龙格-库塔方法 (Runge-Kutta Method)

## 模型简介

四阶龙格-库塔方法是求解常微分方程初值问题的经典数值方法，具有四阶精度，是工程和科学计算中最常用的ODE求解器之一。

## 适用场景

### 数学建模竞赛中的典型应用

1. **人口增长模型** - 求解 Logistic 增长方程
2. **传染病模型** - SIR/SEIR模型的数值求解
3. **物理动力学** - 振动系统、天体运动等
4. **化学反应动力学** - 反应速率方程组
5. **经济动态模型** - 宏观经济增长模型
6. **生物数学** - 捕食者-被捕食者模型
7. **混沌系统** - Lorenz方程、Rossler方程等

### 典型问题特征

- 需要求解一阶或一阶微分方程组
- 已知初值条件
- 需要在指定区间内获得数值解
- 要求较高的计算精度

## 算法原理

对于微分方程 $y' = f(t, y)$，从点 $(t_n, y_n)$ 计算 $(t_{n+1}, y_{n+1})$：

```
k₁ = h·f(tₙ, yₙ)
k₂ = h·f(tₙ + h/2, yₙ + k₁/2)
k₃ = h·f(tₙ + h/2, yₙ + k₂/2)
k₄ = h·f(tₙ + h, yₙ + k₃)

yₙ₊₁ = yₙ + (k₁ + 2k₂ + 2k₃ + k₄)/6
```

## 使用方法

### 1. 基本调用

```python
from M_A1_RungeKutta import runge_kutta_4th
import numpy as np

# 定义微分方程 dy/dt = -2y + 1
def my_equation(t, y):
    return -2 * y + 1

# 初值条件
y0 = np.array([0.5])
t_span = (0, 5)
h = 0.1

# 求解
t_points, y_points = runge_kutta_4th(my_equation, y0, t_span, h)
```

### 2. 参数说明

- **f**: 微分方程右端函数 f(t, y)
- **y0**: 初值条件 (numpy数组)
- **t_span**: 时间区间 (t_start, t_end)
- **h**: 步长 (越小精度越高，但计算量越大)

### 3. 步长选择建议

- 一般情况：h = (t_end - t_start) / 100
- 高精度要求：h ≤ 0.01
- 震荡解：需要更小的步长
- 可通过比较不同步长结果来验证收敛性

## 注意事项

1. **步长选择**: 过大可能导致数值不稳定，过小增加计算成本
2. **初值格式**: 必须使用numpy数组，即使是单变量问题
3. **函数形式**: f(t, y) 必须返回与y0相同维度的数组
4. **内存管理**: 长时间积分时注意结果数组大小

## 代码文件

- **文件名**: `M_A1_RungeKutta.py`
- **主函数**: `runge_kutta_4th(f, y0, t_span, h)`
- **示例**: 洛伦兹吸引子系统求解与3D可视化

## 扩展应用

- 可轻松修改为自适应步长版本
- 支持刚性微分方程（需配合隐式方法）
- 可用于偏微分方程的时间步进